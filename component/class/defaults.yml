parameters:
  billing_collector_cloudservices:
    =_metadata:
      multi_instance: true

    namespace: appuio-cloud-reporting

    secrets:
      odoo:
        credentials:
          stringData:
            ODOO_OAUTH_CLIENT_ID: "?{vaultkv:${cluster:tenant}/${cluster:name}/billing-collector-cloudservices/${_instance}/odoo-oauth-client-id}"
            ODOO_OAUTH_CLIENT_SECRET: "?{vaultkv:${cluster:tenant}/${cluster:name}/billing-collector-cloudservices/${_instance}/odoo-oauth-client-secret}"
      exoscale:
        credentials:
          stringData:
            EXOSCALE_API_KEY: "?{vaultkv:${cluster:tenant}/${cluster:name}/billing-collector-cloudservices/${_instance}/exoscale-key}"
            EXOSCALE_API_SECRET: "?{vaultkv:${cluster:tenant}/${cluster:name}/billing-collector-cloudservices/${_instance}/exoscale-secret}"
      cloudscale:
        credentials:
          stringData:
            CLOUDSCALE_API_TOKEN: "?{vaultkv:${cluster:tenant}/${cluster:name}/billing-collector-cloudservices/${_instance}/token}"
    images:
      collector:
        registry: 'ghcr.io'
        repository: 'vshn/billing-collector-cloudservices'
        tag: change_exporter

    appuioManaged:
      enabled: false
      tenant: ${cluster:tenant}
      salesOrder: ""

    appuioCloud:
      enabled: true
      promUrl: localhost:9090

    clusterId: ${cluster:name}

    odoo:
      url: "https://test.central.vshn.ch/api/v2/authentication/oauth2/token"
      tokenUrl: "https://test.central.vshn.ch/api/v2/authentication/oauth2/token"

    exoscale:
      enabled: false
      dbaas:
        enabled: false
        # in hours
        collectInterval: 1
      # Exoscale metrics are generally fast
      # and we are less likely to miss and dbaas instances
      # in hours
      objectStorage:
        enabled: false
        collectInterval: 23
        # Run the tool only after 6 in the morning.+
        # in hours
        billingHour: 6

    cloudscale:
      enabled: false
      # cloudscale.ch queries are rather slow.
      # Also the metrics are fetched for the previous day, won't change often.
      # in hours
      collectInterval: 23
      # Run the tool only after 6 in the morning.+
      # in hours
      billingHour: 6
      # How many days ago to get the metrics
      # The result is always 1 day of metrics
      days: 1
